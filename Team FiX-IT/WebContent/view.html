<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome</title>
    <link rel="stylesheet" href="index.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
      integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w=="crossorigin="anonymous" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Alfa+Slab+One|Open+Sans" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    
  </head>
  <!-- Header part -->
  <header>
    <div class="tb">
      <h3><i class="fas fa-users"></i>Team FiX-IT</h3
       >
     </div>
    <h1 id="mainHeading">FindMy<span>VaccineCenter</span></h1>
    <nav>
      <ul>
        <li><a class="active" href="home.html"><i class="fa fa-fw fa-home"></i> Home</a></li>
        <li><a href="about.html"><i class="fa fa-fw fa-envelope"></i>About</a></li>
        <li><a href="faq.html"><i class="fa fa-fw fa-search"></i>FAQ'S</a></li>
        <li><a href="login.jsp"><i class="fa fa-fw fa-user"></i> Login</a></li>
      </ul>
    </nav>
  </header><br><br>
<body>


    <div class="form-group row">
        <label class="col-sm-2" for="stateDropdown">State</label>
        <div class="col-sm-6">
            <select class="form-select" id="stateDropdown" >
                <option selected>Open this select menu</option>
              </select>
        </div>
    </div>

    <div class="form-group row mt-5">
        <label class="col-sm-2" for="districtDropdown">District</label>
        <div class="col-sm-6">
            <select  class="form-control" id="districtDropdown">
              </select>
        </div>

      </div>
    <br>
      <button type="button" id="btn">Submit</button>
      
      <table class="table" id="tableCreate"></table>

  <script>
    $(document ).ready(function() {
    console.log("loaded");
    var state = $("#stateDropdown");
    var district = $('#districtDropdown'); 
    var id=0;

    //Call API
    //Populate my dropdowns

  
    $.ajax({
        url: "https://cdn-api.co-vin.in/api/v2/admin/location/states", 
        success: function(results){
            console.log(results);
            console.log(results.states);

            $.each(results.states, function(key, value) {
                state.append('<option value=' + value.state_id + '>' + value.state_name + '</option>');
            });
        }});

        $('#stateDropdown').change(function() {
           var  stateId = $(this).val();
            console.log("StateID : " + stateId);
            $.ajax({
                url: "https://cdn-api.co-vin.in/api/v2/admin/location/districts/"+stateId, 
                success: function(results){
                    console.log(results.districts);
                    district.empty();
                    $.each(results.districts, function(key, value) {
                        district.append('<option value=' + value.district_id + '>' + value.district_name + '</option>');
                    });  // each close
                }}); // ajax close
            });  // change close
   

            var hos=$('#tableCreate');

$('#btn').click(function()
{
    var district=$('#districtDropdown').val();
        console.log(district);
        var d=new Date();
        var today_date=d.getDate();
    $.ajax({
        url:"https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/findByDistrict?district_id="+district+"&date="+today_date,
        success: function(results)
        {
            hos.empty();
                hos.append('<thead class="table-dark">');
                hos.append('<th class="p-3 border" scope="col"> SL. NO.</th>');     
                hos.append('<th class="p-3 border" scope="col"> NAME</th>');
                hos.append('<th class="p-3 border" scope="col"> CENTER ID</th>');
                hos.append('<th class="p-3 border" scope="col"> AVAILABILITY OF DOSE 1</th>');
                hos.append('<th class="p-3 border" scope="col"> AVAILABILITY OF DOSE 2</th>');
                hos.append('<th class="p-3 border" scope="col"> AVAILABILITY OF CAPACITY</th>');
                hos.append('<th class="p-3 border" scope="col"> FEE</th>');
                hos.append('<th class="p-3 border" scope="col"> MINIMUM AGE</th>');
                hos.append('<th class="p-3 border"  scope="col"> VACCINE</th>');
                hos.append('<th class="p-3 border" scope="col"> SLOTS</th>');
                hos.append('</thead>');
            $.each(results.sessions, function(key,value){
                id=id+1;
                hos.append('<tr>');
                hos.append('<td class="p-3 border">'+ id + '</td>');
                hos.append('<td class="p-3 border" value='+value.name+'>'+value.name+'</td>');
                hos.append('<td class="p-3 border" value='+value.center_id+'>'+value.center_id+'</td>');
                hos.append('<td  class="p-3 border" value='+value.available_capacity_dose1+'>'+value.available_capacity_dose1+'</td>');
                hos.append('<td  class="p-3 border" value='+value.available_capacity_dose2+'>'+value.available_capacity_dose2+'</td>');
                hos.append('<td  class="p-3 border" value='+value.available_capacity+'>'+value.available_capacity+'</td>');
                hos.append('<td  class="p-3 border" value='+ value.fee+'>'+value.fee+'</td>');
                hos.append('<td  class="p-3 border" value='+ value.min_age_limit+'>'+value.min_age_limit+'</td>');
                hos.append('<td  class="p-3 border" value='+value.vaccine+'>'+value.vaccine+'</td>');
                hos.append('<td   class="p-3 border" value='+value.slots+'>'+value.slots+'</td>');
                hos.append('</tr>');
                
            })
            id=0;

        }
});
});
});
    </script>    
</body>

 <!-- Fotter part -->   
  <footer class="footer">
    <div>
      <h2>Contact</h2>
      <h2 text-color="black"><a href="mailto:plavanya.cs051@gmail.com">Email us</a></h2>
    </div>
    <li>
      <h3 style="font-weight: bold;">Members</h3>
      <ul>
        <ol>Lavanya P, Sindhu H</ol>
        <ol>DivyaShree U M , Shwetha K J,Harshitha T K</ol>
      </ul>
    </li><br><br><br><br><br><br>
    <div class="legal">
    <p>&copy; 2021 Team FiX-IT All rights reserved.</p>

    <div class="legal__links">
      <span>Made with <span class="heart">ðŸ§¡</span><b>Love by FiX-IT</b></span>
    </div>
  </footer>
  </body>
  </html>
  